From 46d3f7d5f396bee652a3dc173186a5d93f508691 Mon Sep 17 00:00:00 2001
From: "Eric S. Raymond" <esr@thyrsus.com>
Date: Mon, 21 Jan 2019 15:53:55 -0500
Subject: [PATCH] Prevent possible NULL deref during shutdown of neoclock
 driver.

---
 ntpd/refclock_neoclock.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/ntpd/refclock_neoclock.c b/ntpd/refclock_neoclock.c
index a3bd79dd5..1b6461a2f 100644
--- a/ntpd/refclock_neoclock.c
+++ b/ntpd/refclock_neoclock.c
@@ -369,12 +369,12 @@ neoclock4x_shutdown(
 	    free(up);
 	    pp->unitptr = NULL;
 	}
-    }
 
-    msyslog(LOG_ERR, "REFCLOCK: NeoClock4X(%d): shutdown", pp->refclkunit);
+	msyslog(LOG_ERR, "REFCLOCK: NeoClock4X(%d): shutdown", pp->refclkunit);
 
-    NLOG(NLOG_CLOCKINFO)
-	msyslog(LOG_INFO, "REFCLOCK: NeoClock4X(%d): receiver shutdown done", pp->refclkunit);
+	NLOG(NLOG_CLOCKINFO)
+	    msyslog(LOG_INFO, "REFCLOCK: NeoClock4X(%d): receiver shutdown done", pp->refclkunit);
+    }
 }
 
 static void
-- 
2.17.1

