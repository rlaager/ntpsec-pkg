Origin: upstream, https://gitlab.com/NTPsec/ntpsec/commit/acb2ecdcabad2ab42e9c6352999e174dd102eb3f
Bug: https://gitlab.com/NTPsec/ntpsec/issues/509
From: "Gary E. Miller" <gem@rellim.com>
Date: Mon, 22 Oct 2018 13:47:20 -0700
Subject: [PATCH] ntp_control: Stop potentially dereferencing a NULL pointer.

---
 ntpd/ntp_control.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/ntpd/ntp_control.c b/ntpd/ntp_control.c
index 312146f12..b206b4364 100644
--- a/ntpd/ntp_control.c
+++ b/ntpd/ntp_control.c
@@ -2892,6 +2892,7 @@ write_variables(
 	const struct ctl_var *v;
 	int ext_var;
 	char *valuep;
+	char nulltxt[1] = { '\0' };
 	long val;
 	size_t octets;
 	char *vareqv;
@@ -2936,6 +2937,9 @@ write_variables(
 			ctl_error(CERR_PERMISSION);
 			return;
 		}
+		if (NULL == valuep)
+			valuep = nulltxt;
+
 		errno = 0;
 		if (!ext_var &&
                     (*valuep == '\0' ||
-- 
2.18.1

